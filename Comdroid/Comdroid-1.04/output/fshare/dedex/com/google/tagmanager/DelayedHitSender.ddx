.class com/google/tagmanager/DelayedHitSender
.super java/lang/Object
.source DelayedHitSender.java
.implements com/google/tagmanager/HitSender

.field private static sInstance Lcom/google/tagmanager/DelayedHitSender;
.field private static final sInstanceLock Ljava/lang/Object;
.field private mRateLimiter Lcom/google/tagmanager/RateLimiter;
.field private mSendingThread Lcom/google/tagmanager/HitSendingThread;
.field private mWrapperQueryParameter Ljava/lang/String;
.field private mWrapperUrl Ljava/lang/String;

.method static <clinit>()V
.limit registers 1
.line 23
	new-instance	v0,java/lang/Object
; v0 : Ljava/lang/Object;
	invoke-direct	{v0},java/lang/Object/<init>	; <init>()V
; v0 : Ljava/lang/Object;
	sput-object	v0,com/google/tagmanager/DelayedHitSender.sInstanceLock Ljava/lang/Object;
; v0 : Ljava/lang/Object;
	return-void	
.end method

.method private <init>(Landroid/content/Context;)V
.annotation buildVisibility Lcom/google/android/gms/common/util/VisibleForTesting;
.end annotation
.limit registers 4
; this: v2 (Lcom/google/tagmanager/DelayedHitSender;)
; parameter[0] : v3 (Landroid/content/Context;)
.line 32
	invoke-static	{v3},com/google/tagmanager/HitSendingThreadImpl/getInstance	; getInstance(Landroid/content/Context;)Lcom/google/tagmanager/HitSendingThreadImpl;
; v3 : Landroid/content/Context;
	move-result-object	v0
; v0 : Lcom/google/tagmanager/HitSendingThreadImpl;
	new-instance	v1,com/google/tagmanager/SendHitRateLimiter
; v1 : Lcom/google/tagmanager/SendHitRateLimiter;
	invoke-direct	{v1},com/google/tagmanager/SendHitRateLimiter/<init>	; <init>()V
; v1 : Lcom/google/tagmanager/SendHitRateLimiter;
	invoke-direct	{v2,v0,v1},com/google/tagmanager/DelayedHitSender/<init>	; <init>(Lcom/google/tagmanager/HitSendingThread;Lcom/google/tagmanager/RateLimiter;)V
; v2 : Lcom/google/tagmanager/DelayedHitSender; , v0 : Lcom/google/tagmanager/HitSendingThreadImpl; , v1 : Lcom/google/tagmanager/SendHitRateLimiter;
.line 33
	return-void	
.end method

.method <init>(Lcom/google/tagmanager/HitSendingThread;Lcom/google/tagmanager/RateLimiter;)V
.annotation buildVisibility Lcom/google/android/gms/common/util/VisibleForTesting;
.end annotation
.limit registers 3
; this: v0 (Lcom/google/tagmanager/DelayedHitSender;)
; parameter[0] : v1 (Lcom/google/tagmanager/HitSendingThread;)
; parameter[1] : v2 (Lcom/google/tagmanager/RateLimiter;)
.line 36
	invoke-direct	{v0},java/lang/Object/<init>	; <init>()V
; v0 : Lcom/google/tagmanager/DelayedHitSender;
.line 37
	iput-object	v1,v0,com/google/tagmanager/DelayedHitSender.mSendingThread Lcom/google/tagmanager/HitSendingThread;
; v1 : Lcom/google/tagmanager/HitSendingThread; , v0 : Lcom/google/tagmanager/DelayedHitSender;
.line 38
	iput-object	v2,v0,com/google/tagmanager/DelayedHitSender.mRateLimiter Lcom/google/tagmanager/RateLimiter;
; v2 : Lcom/google/tagmanager/RateLimiter; , v0 : Lcom/google/tagmanager/DelayedHitSender;
.line 39
	return-void	
.end method

.method public static getInstance(Landroid/content/Context;)Lcom/google/tagmanager/HitSender;
.limit registers 3
; parameter[0] : v2 (Landroid/content/Context;)
.catch java/lang/Exception from le8ada to le8afc using le8af8
.line 42
	sget-object	v1,com/google/tagmanager/DelayedHitSender.sInstanceLock Ljava/lang/Object;
; v1 : Ljava/lang/Object;
	monitor-enter	v1
; v1 : Ljava/lang/Object;
le8ada:
.line 43
	sget-object	v0,com/google/tagmanager/DelayedHitSender.sInstance Lcom/google/tagmanager/DelayedHitSender;
; v0 : Lcom/google/tagmanager/DelayedHitSender;
	if-nez	v0,le8af0
; v0 : Lcom/google/tagmanager/DelayedHitSender;
.line 44
	new-instance	v0,com/google/tagmanager/DelayedHitSender
; v0 : Lcom/google/tagmanager/DelayedHitSender;
	invoke-direct	{v0,v2},com/google/tagmanager/DelayedHitSender/<init>	; <init>(Landroid/content/Context;)V
; v0 : Lcom/google/tagmanager/DelayedHitSender; , v2 : Landroid/content/Context;
	sput-object	v0,com/google/tagmanager/DelayedHitSender.sInstance Lcom/google/tagmanager/DelayedHitSender;
; v0 : Lcom/google/tagmanager/DelayedHitSender;
le8af0:
.line 46
	sget-object	v0,com/google/tagmanager/DelayedHitSender.sInstance Lcom/google/tagmanager/DelayedHitSender;
; v0 : Lcom/google/tagmanager/DelayedHitSender;
	monitor-exit	v1
; v1 : Ljava/lang/Object;
	return-object	v0
; v0 : Lcom/google/tagmanager/DelayedHitSender;
le8af8:
.line 47
	move-exception	v0
; v0 : java/lang/Exception
	monitor-exit	v1
; v1 : Ljava/lang/Object;
le8afc:
	throw	v0
; v0 : java/lang/Exception
.end method

.method public sendHit(Ljava/lang/String;)Z
.limit registers 6
; this: v4 (Lcom/google/tagmanager/DelayedHitSender;)
; parameter[0] : v5 (Ljava/lang/String;)
.catch java/io/UnsupportedEncodingException from le8b4a to le8bcc using le8bda
	const/4	v1,0
; v1 : single-length
.line 63
	iget-object	v2,v4,com/google/tagmanager/DelayedHitSender.mRateLimiter Lcom/google/tagmanager/RateLimiter;
; v2 : Lcom/google/tagmanager/RateLimiter; , v4 : Lcom/google/tagmanager/DelayedHitSender;
	invoke-interface	{v2},com/google/tagmanager/RateLimiter/tokenAvailable	; tokenAvailable()Z
; v2 : Lcom/google/tagmanager/RateLimiter;
	move-result	v2
; v2 : single-length
	if-nez	v2,le8b3a
; v2 : single-length
.line 64
	const-string	v2,"Too many urls sent too quickly with the TagManagerSender, rate limiting invoked."
; v2 : Ljava/lang/String;
	invoke-static	{v2},com/google/tagmanager/Log/w	; w(Ljava/lang/String;)V
; v2 : Ljava/lang/String;
le8b38:
.line 79
	return	v1
; v1 : single-length
le8b3a:
.line 68
	iget-object	v2,v4,com/google/tagmanager/DelayedHitSender.mWrapperUrl Ljava/lang/String;
; v2 : Ljava/lang/String; , v4 : Lcom/google/tagmanager/DelayedHitSender;
	if-eqz	v2,le8bcc
; v2 : Ljava/lang/String;
	iget-object	v2,v4,com/google/tagmanager/DelayedHitSender.mWrapperQueryParameter Ljava/lang/String;
; v2 : Ljava/lang/String; , v4 : Lcom/google/tagmanager/DelayedHitSender;
	if-eqz	v2,le8bcc
; v2 : Ljava/lang/String;
le8b4a:
.line 70
	new-instance	v2,java/lang/StringBuilder
; v2 : Ljava/lang/StringBuilder;
	invoke-direct	{v2},java/lang/StringBuilder/<init>	; <init>()V
; v2 : Ljava/lang/StringBuilder;
	iget-object	v3,v4,com/google/tagmanager/DelayedHitSender.mWrapperUrl Ljava/lang/String;
; v3 : Ljava/lang/String; , v4 : Lcom/google/tagmanager/DelayedHitSender;
	invoke-virtual	{v2,v3},java/lang/StringBuilder/append	; append(Ljava/lang/String;)Ljava/lang/StringBuilder;
; v2 : Ljava/lang/StringBuilder; , v3 : Ljava/lang/String;
	move-result-object	v2
; v2 : Ljava/lang/StringBuilder;
	const-string	v3,"?"
; v3 : Ljava/lang/String;
	invoke-virtual	{v2,v3},java/lang/StringBuilder/append	; append(Ljava/lang/String;)Ljava/lang/StringBuilder;
; v2 : Ljava/lang/StringBuilder; , v3 : Ljava/lang/String;
	move-result-object	v2
; v2 : Ljava/lang/StringBuilder;
	iget-object	v3,v4,com/google/tagmanager/DelayedHitSender.mWrapperQueryParameter Ljava/lang/String;
; v3 : Ljava/lang/String; , v4 : Lcom/google/tagmanager/DelayedHitSender;
	invoke-virtual	{v2,v3},java/lang/StringBuilder/append	; append(Ljava/lang/String;)Ljava/lang/StringBuilder;
; v2 : Ljava/lang/StringBuilder; , v3 : Ljava/lang/String;
	move-result-object	v2
; v2 : Ljava/lang/StringBuilder;
	const-string	v3,"="
; v3 : Ljava/lang/String;
	invoke-virtual	{v2,v3},java/lang/StringBuilder/append	; append(Ljava/lang/String;)Ljava/lang/StringBuilder;
; v2 : Ljava/lang/StringBuilder; , v3 : Ljava/lang/String;
	move-result-object	v2
; v2 : Ljava/lang/StringBuilder;
	const-string	v3,"UTF-8"
; v3 : Ljava/lang/String;
	invoke-static	{v5,v3},java/net/URLEncoder/encode	; encode(Ljava/lang/String;Ljava/lang/String;)Ljava/lang/String;
; v5 : Ljava/lang/String; , v3 : Ljava/lang/String;
	move-result-object	v3
; v3 : Ljava/lang/String;
	invoke-virtual	{v2,v3},java/lang/StringBuilder/append	; append(Ljava/lang/String;)Ljava/lang/StringBuilder;
; v2 : Ljava/lang/StringBuilder; , v3 : Ljava/lang/String;
	move-result-object	v2
; v2 : Ljava/lang/StringBuilder;
	invoke-virtual	{v2},java/lang/StringBuilder/toString	; toString()Ljava/lang/String;
; v2 : Ljava/lang/StringBuilder;
	move-result-object	v5
; v5 : Ljava/lang/String;
.line 71
	new-instance	v2,java/lang/StringBuilder
; v2 : Ljava/lang/StringBuilder;
	invoke-direct	{v2},java/lang/StringBuilder/<init>	; <init>()V
; v2 : Ljava/lang/StringBuilder;
	const-string	v3,"Sending wrapped url hit: "
; v3 : Ljava/lang/String;
	invoke-virtual	{v2,v3},java/lang/StringBuilder/append	; append(Ljava/lang/String;)Ljava/lang/StringBuilder;
; v2 : Ljava/lang/StringBuilder; , v3 : Ljava/lang/String;
	move-result-object	v2
; v2 : Ljava/lang/StringBuilder;
	invoke-virtual	{v2,v5},java/lang/StringBuilder/append	; append(Ljava/lang/String;)Ljava/lang/StringBuilder;
; v2 : Ljava/lang/StringBuilder; , v5 : Ljava/lang/String;
	move-result-object	v2
; v2 : Ljava/lang/StringBuilder;
	invoke-virtual	{v2},java/lang/StringBuilder/toString	; toString()Ljava/lang/String;
; v2 : Ljava/lang/StringBuilder;
	move-result-object	v2
; v2 : Ljava/lang/String;
	invoke-static	{v2},com/google/tagmanager/Log/v	; v(Ljava/lang/String;)V
; v2 : Ljava/lang/String;
le8bcc:
.line 78
	iget-object	v1,v4,com/google/tagmanager/DelayedHitSender.mSendingThread Lcom/google/tagmanager/HitSendingThread;
; v1 : Lcom/google/tagmanager/HitSendingThread; , v4 : Lcom/google/tagmanager/DelayedHitSender;
	invoke-interface	{v1,v5},com/google/tagmanager/HitSendingThread/sendHit	; sendHit(Ljava/lang/String;)V
; v1 : Lcom/google/tagmanager/HitSendingThread; , v5 : Ljava/lang/String;
.line 79
	const/4	v1,1
; v1 : single-length
	goto	le8b38
le8bda:
.line 72
	move-exception	v0
; v0 : java/io/UnsupportedEncodingException
.line 73
	const-string	v2,"Error wrapping URL for testing."
; v2 : Ljava/lang/String;
	invoke-static	{v2,v0},com/google/tagmanager/Log/w	; w(Ljava/lang/String;Ljava/lang/Throwable;)V
; v2 : Ljava/lang/String; , v0 : java/io/UnsupportedEncodingException
	goto	le8b38
.end method

.method public setUrlWrapModeForTesting(Ljava/lang/String;Ljava/lang/String;)V
.limit registers 3
; this: v0 (Lcom/google/tagmanager/DelayedHitSender;)
; parameter[0] : v1 (Ljava/lang/String;)
; parameter[1] : v2 (Ljava/lang/String;)
.line 51
	iput-object	v1,v0,com/google/tagmanager/DelayedHitSender.mWrapperUrl Ljava/lang/String;
; v1 : Ljava/lang/String; , v0 : Lcom/google/tagmanager/DelayedHitSender;
.line 52
	iput-object	v2,v0,com/google/tagmanager/DelayedHitSender.mWrapperQueryParameter Ljava/lang/String;
; v2 : Ljava/lang/String; , v0 : Lcom/google/tagmanager/DelayedHitSender;
.line 53
	return-void	
.end method


